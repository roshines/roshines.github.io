<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
    <meta name="description" content="Lun4R|Nepnep|åŠ¡å†œ|å°èœé¸¡ä¸€æš|ddddhm|åˆä¹–åˆæ€‚.jpg">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    usb |
    
    sharun&#39;s blogs</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="sharun's blogs" type="application/atom+xml">
</head>

<body>
<main class="content">
  <section class="outer">
  <article id="post-cnblog_12455527" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      usb
    </h1>
  
  




    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/10/cnblog_12455527/" class="article-date">
  <time datetime="2020-03-09T22:33:00.000Z" itemprop="datePublished">2020-03-10</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">ç¬”è®°</a>
  </div>

    </div>
    

    
    
<div class="tocbot"></div>

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h1 id="è¿™æ˜¯ğŸ‘‰usbğŸ‘ˆçš„æ‘˜è¦"><a href="#è¿™æ˜¯ğŸ‘‰usbğŸ‘ˆçš„æ‘˜è¦" class="headerlink" title="è¿™æ˜¯ğŸ‘‰usbğŸ‘ˆçš„æ‘˜è¦"></a><a href="../../../../2020/03/10/cnblog_12455527/">è¿™æ˜¯ğŸ‘‰usbğŸ‘ˆçš„æ‘˜è¦</a></h1><a id="more"></a>
<p>æ‰“å¼€ä¹‹åæ˜¯ä¸€ä¸ªæµé‡åŒ…</p>
<p><img src="https://img2020.cnblogs.com/i-beta/1619455/202003/1619455-20200310142459674-223493812.png"></p>
<p>ç”¨wiresharkå¯¼å‡ºHTTPæ–‡ä»¶ï¼Œæœ‰ä¸ªupload,ç”¨ä¸€ä¸‹binwalkï¼Œå‡ºæ¥äº†ä¸€ä¸ªé•œåƒæ–‡ä»¶</p>
<p><img src="https://img2020.cnblogs.com/i-beta/1619455/202003/1619455-20200310142603761-942514529.png"></p>
<p> ç”¨volatilityæœä¸€ä¸‹ï¼Œå‘½ä»¤é‡Œæœ‰ä¸€ä¸ªå¯†ç ï¼Œçœ‹è§äº†ä½†æ˜¯åæ¥ç»™å¿˜äº†ã€‚ã€‚ã€‚</p>
<p>æ–‡ä»¶é‡Œæœ‰ä¸€ä¸ªflag.imgï¼Œå¯¼å‡º</p>
<p>é‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå¯¼å‡º</p>
<p>æˆ–è€…ç”¨å–è¯å¤§å¸ˆç›´æ¥æ‰“å¼€data.vmemå°±èƒ½çœ‹åˆ°å‹ç¼©åŒ…</p>
<p>ç”¨cmdé‡Œçš„å¯†ç è§£å‹å‹ç¼©åŒ…</p>
<p>ä¸€ä¸²å­—ç¬¦ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯usbé”®ç›˜ä¸ç”µè„‘é€šä¿¡çš„æµé‡</p>
<p>ç”¨ä¸€ä¸‹ç½‘ä¸Šæœåˆ°çš„è„šæœ¬</p>
<pre><code>import sys
import os


usb_codes = &#123;
   0x04:&quot;aA&quot;, 0x05:&quot;bB&quot;, 0x06:&quot;cC&quot;, 0x07:&quot;dD&quot;, 0x08:&quot;eE&quot;, 0x09:&quot;fF&quot;,
   0x0A:&quot;gG&quot;, 0x0B:&quot;hH&quot;, 0x0C:&quot;iI&quot;, 0x0D:&quot;jJ&quot;, 0x0E:&quot;kK&quot;, 0x0F:&quot;lL&quot;,
   0x10:&quot;mM&quot;, 0x11:&quot;nN&quot;, 0x12:&quot;oO&quot;, 0x13:&quot;pP&quot;, 0x14:&quot;qQ&quot;, 0x15:&quot;rR&quot;,
   0x16:&quot;sS&quot;, 0x17:&quot;tT&quot;, 0x18:&quot;uU&quot;, 0x19:&quot;vV&quot;, 0x1A:&quot;wW&quot;, 0x1B:&quot;xX&quot;,
   0x1C:&quot;yY&quot;, 0x1D:&quot;zZ&quot;, 0x1E:&quot;1!&quot;, 0x1F:&quot;2@&quot;, 0x20:&quot;3#&quot;, 0x21:&quot;4$&quot;,
   0x22:&quot;5%&quot;, 0x23:&quot;6^&quot;, 0x24:&quot;7&amp;&quot;, 0x25:&quot;8*&quot;, 0x26:&quot;9(&quot;, 0x27:&quot;0)&quot;,
   0x2C:&quot;  &quot;, 0x2D:&quot;-_&quot;, 0x2E:&quot;=+&quot;, 0x2F:&quot;[&#123;&quot;, 0x30:&quot;]&#125;&quot;,  0x32:&quot;#~&quot;,
   0x33:&quot;;:&quot;, 0x34:&quot;&#39;\&quot;&quot;,  0x36:&quot;,&lt;&quot;,  0x37:&quot;.&gt;&quot;, 0x4f:&quot;&gt;&quot;, 0x50:&quot;&lt;&quot;
   &#125;

def code2chr(filepath):
    lines = []
    pos = 0
    for x in open(filepath,&quot;r&quot;).readlines():
        code = int(x[6:8],16)   # å³ç¬¬ä¸‰ä¸ªå­—èŠ‚
        if code == 0:
            continue
        # newline or down arrow - move down
        if code == 0x51 or code == 0x28:
            pos += 1
            continue
        # up arrow - move up
        if code == 0x52:
            pos -= 1
            continue

        # select the character based on the Shift key
        while len(lines) &lt;= pos:
            lines.append(&quot;&quot;)
        if code in range(4,81):
            if int(x[0:2],16) == 2:
                lines[pos] += usb_codes[code][1]
            else:
                lines[pos] += usb_codes[code][0]

    for x in lines:
        print(x)


if __name__ == &quot;__main__&quot;:
    # check argv
    filepath = &#39;usbdata.txt&#39;
    code2chr(filepath)
    &#39;&#39;&#39;
    if len(sys.argv) != 2:
        print(&quot;Usage:\n\tpython keyboardScanCode.py datafile.txt\nhow to get datafile:\t tshark -r file.usb.pcapng -T fields -e usb.capdata &gt; datafile.txt&quot;)
        exit(1)
    else:
        filepath = sys.argv[1]
        code2chr(filepath)
    &#39;&#39;&#39;</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://sharun.xyz/2020/03/10/cnblog_12455527/" data-id="ckhagon4s00182d3qhfxf44j7" class="article-share-link">
        Share
      </a>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E5%9B%AD/" rel="tag">åšå®¢å›­</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%90%AC%E5%AE%B6/" rel="tag">æ¬å®¶</a></li></ul>

    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2020/03/11/cnblog_12465071/" class="article-nav-link">
        <strong class="article-nav-caption">Newer</strong>
        <div class="article-nav-title">
          
            jarvisoj MISC å–è¯2
          
        </div>
      </a>
    
    
      <a href="/2020/03/05/cnblog_12420367/" class="article-nav-link">
        <strong class="article-nav-caption">Older</strong>
        <div class="article-nav-title">nèµ› ML ç¬¬ä¸€æ­¥ï¼ˆpythonè§£å†³ï¼‰</div>
      </a>
    
  </nav>


  

  
  
  
  

</article>
</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
    <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2020 sharun&#39;s blogs</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a target="_blank" rel="noopener" href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="sharun&#39;s blogs"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">Gallery</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>

<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>



<script src="/js/ocean.js"></script>


</body>
</html>