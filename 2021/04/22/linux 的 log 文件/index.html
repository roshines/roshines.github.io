<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="sharun">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="sharun">
    
    <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="Lun4R|Nepnep|务农|小菜鸡一枚|ddddhm|又乖又怂.jpg">
    <meta name="description" content="常见的Linux操作系统登录文件有如下几个： 1）&#x2F;var&#x2F;log&#x2F;secure：记录登录系统存取数据的文件; 例如pop3，ssh，telnet，ftp等都会记录在此. 2）&#x2F;ar&#x2F;log&#x2F;wtmp：记录登录这的信息记录，被编码过，所以必须以last解析; 3）&#x2F;var&#x2F;log&#x2F;message:jihu所有的开机系统发生的错误都会在此记录; 4）&#x2F;var&#x2F;log&#x2F;boot.log：记录一些开机或">
<meta property="og:type" content="article">
<meta property="og:title" content="linux中log取证">
<meta property="og:url" content="http://sharun.xyz/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/index.html">
<meta property="og:site_name" content="sharun&#39;s blogs">
<meta property="og:description" content="常见的Linux操作系统登录文件有如下几个： 1）&#x2F;var&#x2F;log&#x2F;secure：记录登录系统存取数据的文件; 例如pop3，ssh，telnet，ftp等都会记录在此. 2）&#x2F;ar&#x2F;log&#x2F;wtmp：记录登录这的信息记录，被编码过，所以必须以last解析; 3）&#x2F;var&#x2F;log&#x2F;message:jihu所有的开机系统发生的错误都会在此记录; 4）&#x2F;var&#x2F;log&#x2F;boot.log：记录一些开机或">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://assets.smcdn.cn/docs/assets/paste_error_placeholder-b6c71c3140.png?fileGuid=6qXV8qwdW9djrVdp">
<meta property="og:image" content="https://assets.smcdn.cn/docs/assets/paste_error_placeholder-b6c71c3140.png?fileGuid=6qXV8qwdW9djrVdp">
<meta property="article:published_time" content="2021-04-21T16:00:00.000Z">
<meta property="article:modified_time" content="2021-04-22T12:48:15.683Z">
<meta property="article:author" content="sharun">
<meta property="article:tag" content="博客园">
<meta property="article:tag" content="搬家">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://assets.smcdn.cn/docs/assets/paste_error_placeholder-b6c71c3140.png?fileGuid=6qXV8qwdW9djrVdp">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    
    <title>linux中log取证 · Sharun&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="sharun's blogs" type="application/atom+xml">
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >Sharun&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">linux中log取证</a>
            </div>
    </div>
    
    <a class="home-link" href=/>Sharun's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            linux中log取证
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "博客园">博客园</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "搬家">搬家</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">5k</span>Reading time: <span class="post-count reading-time">22 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2021/04/22</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>常见的Linux操作系统登录文件有如下几个：</p>
<p>1）/var/log/secure：记录登录系统存取数据的文件;</p>
<p>例如pop3，ssh，telnet，ftp等都会记录在此.</p>
<p>2）/ar/log/wtmp：记录登录这的信息记录，被编码过，所以必须以last解析;</p>
<p>3）/var/log/message:jihu所有的开机系统发生的错误都会在此记录;</p>
<p>4）/var/log/boot.log：记录一些开机或者关机启动的一些服务显示的启动或者关闭的信息;</p>
<p>5）/var/log/maillog：记录邮件的存取和往来;</p>
<p>6）/var/log/cron：用来记录crontab这个服务的内容;</p>
<p>7）/var/log/httpd，/var/log/mysqld.log等等文件，记录几个不同的网络服务的记录文件;</p>
<p>8)/var/log/acpid ,   ACPI - Advanced Configuration and Power Interface，表示高级配置和电源管理接口。</p>
<p>后面的 d 表示 deamon 。 acpid 也就是 the ACPI event daemon 。 也就是 acpi 的消息进程。用来控制、获取、管理 acpi 的状态的服务程序。</p>
<p>9)/var/run/utmp 记录着现在登录的用户;</p>
<p>10)/var/log/lastlog 记录每个用户最后的登录信息;</p>
<p>11)/var/log/btmp 记录错误的登录尝试;</p>
<p>12)/var/log/dmesg内核日志;</p>
<p>13)/var/log/cpus CPU的处理信息；</p>
<p>14）/var/log/syslog 事件记录监控程序日志；</p>
<p>15）/var/log/auth.log 用户认证日志；</p>
<p>16）/var/log/daemon.log 系统进程日志；</p>
<p>17）/var/log/mail.err 邮件错误信息；</p>
<p>18）/var/log/mail.info 邮件信息；</p>
<p>19）/var/log/mail.warn 邮件警告信息；</p>
<p>20)/var/log/daemon.log 系统监控程序产生的信息;</p>
<p>21)/var/log/kern 内核产生的信息;</p>
<p>22)/var/log/lpr   行打印机假脱机系统产生的信息;</p>
<hr>
<hr>
<h1 id="如何查看linux系统下的各种日志文件-linux-系统日志的分析大全"><a href="#如何查看linux系统下的各种日志文件-linux-系统日志的分析大全" class="headerlink" title="如何查看linux系统下的各种日志文件 linux 系统日志的分析大全"></a>如何查看linux系统下的各种日志文件 linux 系统日志的分析大全</h1><p><strong>日志分类:</strong></p>
<p><strong>1. 连接时间的日志</strong></p>
<p><strong>连接时间日志一般由/var/log/wtmp和/var/run/utmp这两个文件记录，不过这</strong></p>
<p><strong>两个文件无法直接cat查看，并且该文件由系统自动更新，可以通过如下：</strong></p>
<p><strong>w/who/finger/id/last/lastlog/ac 进行查看</strong></p>
<p>[root@xhot ~]# who</p>
<p>root tty1 2010-10-06 22:56</p>
<p>root pts/0 2010-10-06 22:26 (218.192.87.4)</p>
<p>root pts/1 2010-10-06 23:41 (218.192.87.4)</p>
<p>root pts/3 2010-10-06 23:18 (218.192.87.4)</p>
<p>[root@xhot ~]# w</p>
<p>01:01:02 up 2:36, 4 users, load average: 0.15, 0.03, 0.01</p>
<p>USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT</p>
<p>root tty1 - 22:56 1:20m 0.16s 0.16s -bash</p>
<p>root pts/0 218.192.87.4 22:26 2:05m 0.18s 0.18s -bash</p>
<p>root pts/1 218.192.87.4 23:41 0.00s 0.41s 0.00s w</p>
<p>root pts/3 218.192.87.4 23:18 1:38m 0.03s 0.03s -bash</p>
<p>[root@xhot ~]# ac -p //查看每个用户的连接时间</p>
<p>u51 1.23</p>
<p>u55 0.04</p>
<p>root 95.21 //可以看到root连接时间最长吧</p>
<p>xhot 0.06</p>
<p>user1 3.93</p>
<p>total 100.48</p>
<p>[root@xhot ~]# ac -a //查看所有用户的连接时间</p>
<p>total 100.49</p>
<p>[root@xhot ~]# ac -d //查看用户每天的连接时间</p>
<p>Sep 24 total 0.14</p>
<p>Sep 25 total 14.60</p>
<p>Sep 26 total 13.71</p>
<p>Sep 27 total 21.47</p>
<p>Sep 28 total 11.74</p>
<p>Sep 29 total 6.60</p>
<p>Sep 30 total 8.81</p>
<p>Oct 1 total 9.04</p>
<p>Oct 2 total 0.47 //可以看到我国庆3、4、5号出去玩了</p>
<p>Oct 6 total 8.62</p>
<p>Today total 5.29</p>
<p>其他几个命令不做具体介绍了</p>
<p><strong>2. 进程监控日志</strong></p>
<p><strong>进程统计监控日志在监控用户的操作指令是非常有效的。当服务器最近发现经常</strong></p>
<p><strong>无故关机或者无故被人删除文件等现象时，可以通过使用进程统计日志查看：</strong></p>
<p>[root@xhot ~]# accton /var/account/pacct //开启进程统计日志监控</p>
<p>[root@xhot ~]# lastcomm //查看进程统计日志情况</p>
<p>accton S root pts/1 0.00 secs Thu Oct 7 01:20</p>
<p>accton root pts/1 0.00 secs Thu Oct 7 01:20</p>
<p>ac root pts/1 0.00 secs Thu Oct 7 01:14</p>
<p>ac root pts/1 0.00 secs Thu Oct 7 01:14</p>
<p>free root pts/1 0.00 secs Thu Oct 7 01:10</p>
<p>lastcomm root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>bash F root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>lastcomm root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>ifconfig root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>lastcomm root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>lastcomm root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>lastcomm root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>accton S root pts/1 0.00 secs Thu Oct 7 01:09</p>
<p>[root@xhot ~]# accton //关闭进程统计日志监控</p>
<p><strong>3. 系统和服务日志</strong></p>
<p><strong>系统日志服务是由一个名为syslog的服务管理的，如一下日志文件都是由syslog日志服务驱动的：</strong></p>
<p>/var/log/lastlog ：记录最后一次用户成功登陆的时间、登陆IP等信息</p>
<p>/var/log/messages ：记录Linux操作系统常见的系统和服务错误信息</p>
<p>/var/log/secure ：Linux系统安全日志，记录用户和工作组变坏情况、用户登陆认证情况</p>
<p>/var/log/btmp ：记录Linux登陆失败的用户、时间以及远程IP地址</p>
<p>/var/log/cron ：记录crond计划任务服务执行情况</p>
<p>……</p>
<p>[root@xhot ~]# cat /var/log/lastlog</p>
<p>Lpts/0218.192.87.4</p>
<p>Lpts/1218.192.87.4</p>
<p>Lpts/1218.192.87.4</p>
<p>Lpts/0218.192.87.46</p>
<p>Lpts/0218.192.87.4</p>
<p>……</p>
<p><strong>Linux日志服务介绍</strong></p>
<p><strong>１. 在Linux系统，大部分日志都是由syslog日志服务驱动和管理的</strong></p>
<p>syslog服务由两个重要的配置文件控制管理，分别是/etc/syslog.conf主配置文件和/etc/sysconfig/syslog辅助</p>
<p>配置文件， /etc/init.d/syslog是启动脚本，这里主讲主配置文件/etc/syslog.conf：</p>
<p>/etc/syslog.conf 语句结构：</p>
<p>[root@xhot ~]# grep -v “#” /etc/syslog.conf //列出非#打头的每一行</p>
<p>*.info;mail.none;authpriv.none;cron.none /var/log/messages</p>
<p>authpriv.* /var/log/secure</p>
<p>mail.* -/var/log/maillog</p>
<p>cron.* /var/log/cron</p>
<p>*.emerg *</p>
<p>uucp,news.crit /var/log/spooler</p>
<p>local7.* /var/log/boot.log</p>
<p>选择域(消息类型.错误级别) 动作域</p>
<p><strong>２. 消息类型：</strong>auth,authpriv,security;cron,daemon,kern,lpr,mail, mark,news,syslog,user,uucp,local0~local7.</p>
<p>错误级别：(8级)debug,info,notice,warning|warn;err|error;crit,alert,emerg|panic</p>
<p>动作域：file,user,console,@remote_ip</p>
<p>举如上的/etc/syslog.conf文件三个例子：</p>
<p>*.info;mail.none;authpriv.none;cron.none /var/log/messages</p>
<p>表示info级别的任何消息都发送到/var/log/messages日志文件，但邮件系统、验证系统</p>
<p>和计划任务的错误级别信息就除外，不发送（none表示禁止）</p>
<p>cron.* /var/log/cron 表示所有级别的cron信息发到/var/log/cron文件</p>
<p>*.emerg * 表示emerg错误级别（危险状态）的所有消息类型发给所有用户</p>
<p><strong>Linux日志服务器配置</strong></p>
<p>此服务器的配置非常简单，只是修改一个文件的一个地方，然后重启服务即可：</p>
<p>[root@xhot ~]# grep -v “#” /etc/sysconfig/syslog</p>
<p>SYSLOGD_OPTIONS=”-m 0 -r” //只要在这里添加“-r”就行咯</p>
<p>KLOGD_OPTIONS=”-x”</p>
<p>SYSLOG_UMASK=077</p>
<p>[root@xhot ~]# service syslog restart</p>
<p>关闭内核日志记录器： [确定]</p>
<p>关闭系统日志记录器： [确定]</p>
<p>启动系统日志记录器： [确定]</p>
<p>启动内核日志记录器： [确定]</p>
<p>对于发送消息到服务器的OS，只要在写/etc/syslog.conf主配置文件的时候，作用域</p>
<p>为@server-ip就行了，比如针对218.192.87.24这台日志服务器，把一台ubuntu系统的所有</p>
<p>info级别的auth信息发给日志服务器，那么对于ubuntu系统的/etc/syslog.conf文件最后一</p>
<p>行添加 auth.info @218.192.87.24 就OK了</p>
<p><strong>日志转储服务</strong></p>
<p>系统工作到了一定时间后，日志文件的内容随着时间和访问量的增加而越来越多，</p>
<p>日志文件也越来越大。而且当日志文件超过系统控制范围时候，还会对系统性能</p>
<p>造成影响。转储方式可以设为每年转储、每月转储、每周转储、达到一定大小转储。</p>
<p>在Linux系统，经常使用<strong>“logrotate”</strong>工具进行日志转储，结合<strong>cron</strong>计划任务，可以轻松</p>
<p>实现日志文件的转储。转储方式的设置由<strong>“/etc/logrotate.conf”</strong>配置文件控制：</p>
<p>[root@xhot ~]# cat /etc/logrotate.conf</p>
<h1 id="see-“man-logrotate”-for-details-可以查看帮助文档"><a href="#see-“man-logrotate”-for-details-可以查看帮助文档" class="headerlink" title="see “man logrotate” for details //可以查看帮助文档"></a>see “man logrotate” for details //可以查看帮助文档</h1><h1 id="rotate-log-files-weekly"><a href="#rotate-log-files-weekly" class="headerlink" title="rotate log files weekly"></a>rotate log files weekly</h1><p>weekly //设置每周转储</p>
<h1 id="keep-4-weeks-worth-of-backlogs"><a href="#keep-4-weeks-worth-of-backlogs" class="headerlink" title="keep 4 weeks worth of backlogs"></a>keep 4 weeks worth of backlogs</h1><p>rotate 4 //最多转储4次</p>
<h1 id="create-new-empty-log-files-after-rotating-old-ones"><a href="#create-new-empty-log-files-after-rotating-old-ones" class="headerlink" title="create new (empty) log files after rotating old ones"></a>create new (empty) log files after rotating old ones</h1><p>create //当转储后文件不存储时创建它</p>
<h1 id="uncomment-this-if-you-want-your-log-files-compressed"><a href="#uncomment-this-if-you-want-your-log-files-compressed" class="headerlink" title="uncomment this if you want your log files compressed"></a>uncomment this if you want your log files compressed</h1><p>#compress //以压缩方式转储</p>
<h1 id="RPM-packages-drop-log-rotation-information-into-this-directory"><a href="#RPM-packages-drop-log-rotation-information-into-this-directory" class="headerlink" title="RPM packages drop log rotation information into this directory"></a>RPM packages drop log rotation information into this directory</h1><p>include /etc/logrotate.d //其他日志文件的转储方式，包含在该目录下</p>
<h1 id="no-packages-own-wtmp-–-we’ll-rotate-them-here"><a href="#no-packages-own-wtmp-–-we’ll-rotate-them-here" class="headerlink" title="no packages own wtmp – we’ll rotate them here"></a>no packages own wtmp – we’ll rotate them here</h1><p>/var/log/wtmp { //设置/var/log/wtmp日志文件的转储参数</p>
<p>monthly //每月转储</p>
<p>create 0664 root utmp //转储后文件不存在时创建它，文件所有者为root，</p>
<p>所属组为utmp，对应的权限为0664</p>
<p>rotate 1 //转储一次</p>
<p>}</p>
<h1 id="system-specific-logs-may-be-also-be-configured-here"><a href="#system-specific-logs-may-be-also-be-configured-here" class="headerlink" title="system-specific logs may be also be configured here."></a>system-specific logs may be also be configured here.</h1><p><strong>举两个例子：</strong></p>
<p><strong>为/var/log/news/目录下的所有文件设置转储参数，每周转储，转储2次，转储</strong></p>
<p><strong>时将老的日志文件放到/var/log/news/old目录下，若日志文件不存在，则跳过。完成后重启</strong></p>
<p><strong>news新闻组服务，转储时不压缩</strong>。那么可以在/etc/logrotate.conf文件的最后添加如下：</p>
<p>/var/log/news/*{</p>
<p>monthly</p>
<p>rotate 2</p>
<p>olddir /var/log/news/old</p>
<p>missingok</p>
<p>postrotate</p>
<p>kill -HUP <code>cat /var/run/inn.pid</code></p>
<p>endscript</p>
<p>nocompress</p>
<p>}</p>
<p>另一个例子：<strong>为/var/log/httpd/access.log和/var/log/httpd/error.log日志设置转储参数。转储</strong></p>
<p><strong>5次，转储时发送邮件给</strong><a target="_blank" rel="noopener" href="http://localhost/?fileGuid=6qXV8qwdW9djrVdp">root@localhost</a><strong>用户，当日志文件达到100KB时才转储，转储后重启</strong></p>
<p><strong>httpd服务</strong>，那么可以直接在/etc/logrotate.conf文件的最后添加如下：</p>
<p>/var/log/httpd/access.log /var/log/http/error.log{</p>
<p>rotate 5</p>
<p>mail<a target="_blank" rel="noopener" href="http://localhost/?fileGuid=6qXV8qwdW9djrVdp">root@localhost</a></p>
<p>size=100k</p>
<p>sharedscripts</p>
<p>/sbin/killall -HUP httpd</p>
<p>endscript</p>
<p>}</p>
<p>自定义日志转储（/etc/logrotate.d/*）</p>
<p>通过下面一个例子<strong>将所有类型错误级别为info的日志转储到/var/log/test.log日志文件中，并设置</strong></p>
<p><strong>/var/log/test.log达到50KB后进行转储，转储10次，转储时压缩，转储后重启syslog服务</strong>：</p>
<p><strong>1、修改/etc/syslog.conf文件使得如下：</strong></p>
<p>[root@xhot ~]# tail -1 /etc/syslog.conf //查看该文件的最后一行</p>
<p>*.info /var/log/test.log</p>
<p><strong>2、重启syslog服务：</strong></p>
<p>[root@xhot ~]# /sbin/service syslog restart</p>
<p>关闭内核日志记录器： [确定]</p>
<p>关闭系统日志记录器： [确定]</p>
<p>启动系统日志记录器： [确定]</p>
<p>启动内核日志记录器： [确定]</p>
<p><strong>3、创建/etc/logrotate.d/test.log日志转储参数配置文件，添加如下：</strong></p>
<p>[root@xhot ~]# vim /etc/logrotate.d/test.log</p>
<p>[root@xhot ~]# cat /etc/logrotate.d/test.log</p>
<p>/var/log/test.log{</p>
<p>rotate 10</p>
<p>size = 50k</p>
<p>compress</p>
<p>postrotate</p>
<p>killall -HUP syslog</p>
<p>endscript</p>
<p>}</p>
<p><strong>4、查看文件/etc/cron.daily/logrotate确保如下：</strong></p>
<p>[root@xhot ~]# cat /etc/cron.daily/logrotate</p>
<p>#!/bin/sh</p>
<p>/usr/sbin/logrotate /etc/logrotate.conf</p>
<p>EXITVALUE=$?</p>
<p>if [ $EXITVALUE != 0 ]; then</p>
<p>/usr/bin/logger -t logrotate “ALERT exited abnormally with [$EXITVALUE]”</p>
<p>fi</p>
<p>exit 0</p>
<p><strong>5、查看转储后的文件</strong></p>
<p>[root@xhot log]# pwd</p>
<p>/var/log</p>
<p>[root@xhot log]# ls test.log*</p>
<p>…… //结果等要转储的时候会发现压缩文件和原本的test.log文件</p>
<p>syslog是一个被UNIX和Linux广泛使用的日志系统，Linux系统中大部分的日志文件都是通过它进行管理的。本节将对syslog的功能及配置、日志文件的查看和管理，以及syslog中默认配置的日志文件进行介绍。</p>
<p><strong>12.2.1 syslog简介</strong></p>
<p>syslog是一个历史悠久的日志系统，几乎所有的UNIX和Linux操作系统都是采用syslog进行系统日志的管理和配置。Linux系统内核和许多程序会产生各种错误信息、警告信息和其他的提示信息。这些信息对管理员了解系统的运行状态是非常有用的，所以应该把它们写到日志文件中去。而执行这个过程的程序就是syslog。syslog可以根据信息的来源以及信息的重要程度将信息保存到不同的日志文件中，例如，为了方便查阅，可以把内核信息与其他信息分开，单独保存到一个独立的日志文件中。在默认的syslog配置下，日志文件通常都保存在“/var/log”目录下。syslog的守护进程为syslogd，系统启动时，默认会自动运行syslogd守护进程。</p>
<p>如果要手工启动，可以使用如下命令：</p>
<p>/sbin/syslogd</p>
<p>在修改syslog配置后，需要重新启动syslogd守护进程才能使新的配置生效。其命令如下所示。</p>
<h1 id="killall-HUP-syslogd"><a href="#killall-HUP-syslogd" class="headerlink" title="killall -HUP syslogd"></a>killall -HUP syslogd</h1><p>Red Hat Enterprise Linux 5.2安装后默认就已经在syslog中定义了一些日志文件，这些日志的位置以及它们的说明如表12.2所示。</p>
<p>表12.2 默认配置syslog日志</p>
<table>
<thead>
<tr>
<th align="left">日 志 文 件</th>
<th align="left">说    明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">/var/log/message</td>
<td align="left">系统启动后的信息和错误日志，是Red Hat Linux中最常用的日志之一</td>
</tr>
<tr>
<td align="left">/var/log/secure</td>
<td align="left">与安全相关的日志信息</td>
</tr>
<tr>
<td align="left">/var/log/maillog</td>
<td align="left">与邮件相关的日志信息</td>
</tr>
<tr>
<td align="left">/var/log/cron</td>
<td align="left">与定时任务相关的日志信息</td>
</tr>
<tr>
<td align="left">/var/log/spooler</td>
<td align="left">与UUCP和news设备相关的日志信息</td>
</tr>
<tr>
<td align="left">/var/log/boot.log</td>
<td align="left">守护进程启动和停止相关的日志消息<br></td>
</tr>
</tbody></table>
<h2 id="0x01-Web日志"><a href="#0x01-Web日志" class="headerlink" title="0x01 Web日志"></a>0x01 Web日志</h2><p>Web访问日志记录了Web服务器接收处理请求及运行时错误等各种原始信息。通过对WEB日志进行的安全分析，不仅可以帮助我们定位攻击者，还可以帮助我们还原攻击路径，找到网站存在的安全漏洞并进行修复。</p>
<p>我们来看一条Apache的访问日志：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 - - [11&#x2F;Jun&#x2F;2018:12:47:22 +0800] &quot;GET &#x2F;login.html HTTP&#x2F;1.1&quot; 200 786 &quot;-&quot; &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;66.0.3359.139 Safari&#x2F;537.36&quot;</span><br></pre></td></tr></table></figure>
<p>通过这条Web访问日志，我们可以清楚的得知用户在什么IP、什么时间、用什么操作系统、什么浏览器的情况下访问了你网站的哪个页面，是否访问成功。<br>本文通过介绍Web日志安全分析时的思路和常用的一些技巧。</p>
<h2 id="0x02-日志分析技巧"><a href="#0x02-日志分析技巧" class="headerlink" title="0x02 日志分析技巧"></a>0x02 日志分析技巧</h2><p>在对WEB日志进行安全分析时，一般可以按照两种思路展开，逐步深入，还原整个攻击过程。</p>
<p>第一种：确定入侵的时间范围，以此为线索，查找这个时间范围内可疑的日志，进一步排查，最终确定攻击者，还原攻击过程。</p>
<p>第二种：攻击者在入侵网站后，通常会留下后门维持权限，以方便再次访问，我们可以找到该文件，并以此为线索来展开分析。</p>
<p>常用分析工具：</p>
<p>Window下，推荐用 EmEditor 进行日志分析，支持大文本，搜索效率还不错。</p>
<p>Linux下，使用Shell命令组合查询分析。</p>
<p>Shell+Linux命令实现日志分析，一般结合grep、awk等命令等实现了几个常用的日志分析统计技巧。</p>
<p>Apache日志分析技巧：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、列出当天访问次数最多的IP命令：cut -d- -f 1 log_file|uniq -c | sort -rn | head -20</span><br><span class="line">2、查看当天有多少个IP访问：awk &#39;&#123;print $1&#125;&#39; log_file|sort|uniq|wc -l</span><br><span class="line">3、查看某一个页面被访问的次数：grep &quot;&#x2F;index.php&quot; log_file | wc -l</span><br><span class="line">4、查看每一个IP访问了多少个页面：awk &#39;&#123;++S[$1]&#125; END &#123;for (a in S) print a,S[a]&#125;&#39; log_file</span><br><span class="line">5、将每个IP访问的页面数进行从小到大排序：awk &#39;&#123;++S[$1]&#125; END &#123;for (a in S) print S[a],a&#125;&#39; log_file | sort -n</span><br><span class="line">6、查看某一个IP访问了哪些页面：grep ^111.111.111.111 log_file| awk &#39;&#123;print $1,$7&#125;&#39;</span><br><span class="line">7、去掉搜索引擎统计当天的页面：awk &#39;&#123;print $12,$1&#125;&#39; log_file | grep ^&quot;Mozilla | awk &#39;&#123;print $2&#125;&#39; |sort | uniq | wc -l</span><br><span class="line">8、查看2018年6月21日14时这一个小时内有多少IP访问:awk &#39;&#123;print $4,$1&#125;&#39; log_file | grep 21&#x2F;Jun&#x2F;2018:14 | awk &#39;&#123;print $2&#125;&#39;| sort | uniq | wc -l</span><br></pre></td></tr></table></figure>
<h2 id="0x03-日志分析案例"><a href="#0x03-日志分析案例" class="headerlink" title="0x03 日志分析案例"></a>0x03 日志分析案例</h2><p>Web日志分析实例：通过nginx代理转发到内网某服务器，内网服务器某站点目录下被上传了多个图片木马，虽然II7下不能解析，但还是想找出谁通过什么路径上传的。</p>
<p>在这里，我们遇到了一个问题：由于设置了代理转发，只记录了代理服务器的ip，并没有记录访问者IP？这时候，如何去识别不同的访问者和攻击源呢？</p>
<p>这是管理员日志配置不当的问题，但好在我们可以通过浏览器指纹来定位不同的访问来源，还原攻击路径。</p>
<h3 id="1、定位攻击源"><a href="#1、定位攻击源" class="headerlink" title="1、定位攻击源"></a>1、定位攻击源</h3><p>首先访问图片木马的记录，只找到了一条，由于所有访问日志只记录了代理IP，并不能通过IP来还原攻击路径，这时候，可以利用浏览器指纹来定位。</p>
<p><img src="https://assets.smcdn.cn/docs/assets/paste_error_placeholder-b6c71c3140.png?fileGuid=6qXV8qwdW9djrVdp" alt="图片"></p>
<p>浏览器指纹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mozilla&#x2F;4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident&#x2F;7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E)</span><br></pre></td></tr></table></figure>
<h3 id="2、搜索相关日志记录"><a href="#2、搜索相关日志记录" class="headerlink" title="2、搜索相关日志记录"></a>2、搜索相关日志记录</h3><p>通过筛选与该浏览器指纹有关的日志记录，可以清晰地看到攻击者的攻击路径。</p>
<p><img src="https://assets.smcdn.cn/docs/assets/paste_error_placeholder-b6c71c3140.png?fileGuid=6qXV8qwdW9djrVdp" alt="图片"></p>
<p>3、对找到的访问日志进行解读，攻击者大致的访问路径如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A、攻击者访问首页和登录页B、攻击者访问MsgSjlb.aspx和MsgSebd.aspxC、攻击者访问Xzuser.aspxD、攻击者多次POST（怀疑通过这个页面上传模块缺陷）E、攻击者访问了图片木马</span><br></pre></td></tr></table></figure>
<p>打开网站，访问Xzuser.aspx，确认攻击者通过该页面的进行文件上传了图片木马，同时，发现网站了存在越权访问漏洞，攻击者访问特定URL，无需登录即可进入后台界面。通过日志分析找到网站的漏洞位置并进行修复。</p>
<h2 id="0x04-日志统计分析技巧"><a href="#0x04-日志统计分析技巧" class="headerlink" title="0x04 日志统计分析技巧"></a>0x04 日志统计分析技巧</h2><p>统计爬虫：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E &#39;Googlebot|Baiduspider&#39;  &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | awk &#39;&#123; print $1 &#125;&#39; | sort | uniq</span><br></pre></td></tr></table></figure>
<p>统计浏览器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | grep -v -E &#39;MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon&#39; | sort | uniq -c | sort -r -n | head -n 100</span><br></pre></td></tr></table></figure>
<p>IP 统计：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#39;23&#x2F;May&#x2F;2019&#39; &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | awk &#39;&#123;print $1&#125;&#39; | awk -F&#39;.&#39; &#39;&#123;print $1&quot;.&quot;$2&quot;.&quot;$3&quot;.&quot;$4&#125;&#39; | sort | uniq -c | sort -r -n | head -n 10   2206 219.136.134.13   1497 182.34.15.248   1431 211.140.143.100   1431 119.145.149.106   1427 61.183.15.179   1427 218.6.8.189   1422 124.232.150.171   1421 106.187.47.224   1420 61.160.220.252   1418 114.80.201.18</span><br></pre></td></tr></table></figure>
<p>统计网段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | awk &#39;&#123;print $1&#125;&#39; | awk -F&#39;.&#39; &#39;&#123;print $1&quot;.&quot;$2&quot;.&quot;$3&quot;.0&quot;&#125;&#39; | sort | uniq -c | sort -r -n | head -n 200</span><br></pre></td></tr></table></figure>
<p>统计域名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log |awk &#39;&#123;print $2&#125;&#39;|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure>
<p>HTTP状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log |awk &#39;&#123;print $9&#125;&#39;|sort|uniq -c|sort -rn|more5056585 3041125579 200   7602 400      5 301</span><br></pre></td></tr></table></figure>
<p>URL 统计：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log |awk &#39;&#123;print $7&#125;&#39;|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure>
<p>文件流量统计：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log |awk &#39;&#123;sum[$7]+&#x3D;$10&#125;END&#123;for(i in sum)&#123;print sum[i],i&#125;&#125;&#39;|sort -rn|moregrep &#39; 200 &#39; &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log |awk &#39;&#123;sum[$7]+&#x3D;$10&#125;END&#123;for(i in sum)&#123;print sum[i],i&#125;&#125;&#39;|sort -rn|more</span><br><span class="line">URL访问量统计：</span><br><span class="line">cat &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | awk &#39;&#123;print $7&#125;&#39; | egrep &#39;?|&amp;&#39; | sort | uniq -c | sort -rn | more</span><br></pre></td></tr></table></figure>
<p>脚本运行速度：</p>
<p>查出运行速度最慢的脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -v 0$ &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | awk -F &#39;&quot; &#39; &#39;&#123;print $4&quot; &quot; $1&#125;&#39; web.log | awk &#39;&#123;print $1&quot; &quot;$8&#125;&#39; | sort -n -k 1 -r | uniq &gt; &#x2F;tmp&#x2F;slow_url.txt</span><br></pre></td></tr></table></figure>
<p>IP, URL 抽取：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f &#x2F;www&#x2F;logs&#x2F;access.2019-02-23.log | grep &#39;&#x2F;test.html&#39; | awk &#39;&#123;print $1&quot; &quot;$7&#125;&#39;</span><br></pre></td></tr></table></figure>





    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>Author：<a href="http://sharun.xyz">sharun</a>
            <p>原文链接：<a href="http://sharun.xyz/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/">http://sharun.xyz/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/</a>
            <p>发表日期：<a href="http://sharun.xyz/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/">April 22nd 2021, 12:00:00 am</a>
            <p>更新日期：<a href="http://sharun.xyz/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/">April 22nd 2021, 8:48:15 pm</a>
            <p>版权声明：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2021/01/01/%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%86%B3%E8%B5%9B-%E7%88%86%E7%82%92%E8%85%B0%E8%8A%B1WP/" title= "">
                    <div class="prevTitle">[Untitled Post]</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- gitalk评论 -->

    <!-- utteranc评论 -->

    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:503298621@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/roshines" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8Blinux%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%9A%84%E5%90%84%E7%A7%8D%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6-linux-%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97%E7%9A%84%E5%88%86%E6%9E%90%E5%A4%A7%E5%85%A8"><span class="toc-number">1.</span> <span class="toc-text">如何查看linux系统下的各种日志文件 linux 系统日志的分析大全</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#see-%E2%80%9Cman-logrotate%E2%80%9D-for-details-%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3"><span class="toc-number">2.</span> <span class="toc-text">see “man logrotate” for details &#x2F;&#x2F;可以查看帮助文档</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rotate-log-files-weekly"><span class="toc-number">3.</span> <span class="toc-text">rotate log files weekly</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#keep-4-weeks-worth-of-backlogs"><span class="toc-number">4.</span> <span class="toc-text">keep 4 weeks worth of backlogs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#create-new-empty-log-files-after-rotating-old-ones"><span class="toc-number">5.</span> <span class="toc-text">create new (empty) log files after rotating old ones</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#uncomment-this-if-you-want-your-log-files-compressed"><span class="toc-number">6.</span> <span class="toc-text">uncomment this if you want your log files compressed</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RPM-packages-drop-log-rotation-information-into-this-directory"><span class="toc-number">7.</span> <span class="toc-text">RPM packages drop log rotation information into this directory</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#no-packages-own-wtmp-%E2%80%93-we%E2%80%99ll-rotate-them-here"><span class="toc-number">8.</span> <span class="toc-text">no packages own wtmp – we’ll rotate them here</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#system-specific-logs-may-be-also-be-configured-here"><span class="toc-number">9.</span> <span class="toc-text">system-specific logs may be also be configured here.</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#killall-HUP-syslogd"><span class="toc-number">10.</span> <span class="toc-text">killall -HUP syslogd</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Web%E6%97%A5%E5%BF%97"><span class="toc-number">10.1.</span> <span class="toc-text">0x01 Web日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E6%8A%80%E5%B7%A7"><span class="toc-number">10.2.</span> <span class="toc-text">0x02 日志分析技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B"><span class="toc-number">10.3.</span> <span class="toc-text">0x03 日志分析案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%9A%E4%BD%8D%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">10.3.1.</span> <span class="toc-text">1、定位攻击源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%90%9C%E7%B4%A2%E7%9B%B8%E5%85%B3%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95"><span class="toc-number">10.3.2.</span> <span class="toc-text">2、搜索相关日志记录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E6%97%A5%E5%BF%97%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90%E6%8A%80%E5%B7%A7"><span class="toc-number">10.4.</span> <span class="toc-text">0x04 日志统计分析技巧</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 28
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/09</span><a class="archive-post-title" href= "/2020/11/09/%E9%93%81%E4%B8%89-WP/" >铁三-WP</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/2020/11/09/Volatility/" >volatility</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2021 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/22</span><a class="archive-post-title" href= "/2021/04/22/linux%20%E7%9A%84%20log%20%E6%96%87%E4%BB%B6/" >linux中log取证</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/01</span><a class="archive-post-title" href= "/2021/01/01/%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%86%B3%E8%B5%9B-%E7%88%86%E7%82%92%E8%85%B0%E8%8A%B1WP/" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span><a class="archive-post-title" href= "/2020/11/02/cnblog_13913331/" >湖湘杯-MISC-WP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span><a class="archive-post-title" href= "/2020/08/21/cnblog_13542994/" >爆炒腰花-2020国赛WP</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/16</span><a class="archive-post-title" href= "/2020/08/16/cnblog_13514707/" >HWS选拔赛-MISC</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/16</span><a class="archive-post-title" href= "/2020/08/16/cnblog_13514165/" >爆炒腰花-蓝帽杯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/26</span><a class="archive-post-title" href= "/2020/07/26/cnblog_13381598/" >Lun4R-CyBRICSCTF wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2020/07/25/cnblog_13378245/" >Lun4R-dasctf MISC1 welcome</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/24</span><a class="archive-post-title" href= "/2020/07/24/cnblog_13374692/" >计网小笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/17</span><a class="archive-post-title" href= "/2020/07/17/cnblog_13331754/" >数据恢复之FAT和NTFS</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/06</span><a class="archive-post-title" href= "/2020/06/06/cnblog_13054815/" >HSCTF  WP   ——Lun4R</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span><a class="archive-post-title" href= "/2020/05/19/cnblog_12919431/" >服务器运维抓包练习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span><a class="archive-post-title" href= "/2020/05/16/cnblog_12900273/" >2020网鼎杯青龙组 MISC 虚幻2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span><a class="archive-post-title" href= "/2020/05/16/cnblog_12898784/" >2020网鼎杯白虎组 MISC 密码柜（未解出）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/26</span><a class="archive-post-title" href= "/2020/04/26/cnblog_12781871/" >安恒四月春季赛 MISC keyboard</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/19</span><a class="archive-post-title" href= "/2020/04/19/cnblog_12733364/" >虎符ctf-MISC-奇怪的组织(看完官方题解，找到了)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/11</span><a class="archive-post-title" href= "/2020/03/11/cnblog_12465071/" >jarvisoj MISC 取证2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/10</span><a class="archive-post-title" href= "/2020/03/10/cnblog_12455527/" >usb</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/05</span><a class="archive-post-title" href= "/2020/03/05/cnblog_12420367/" >n赛 ML 第一步（python解决）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/04</span><a class="archive-post-title" href= "/2020/03/04/cnblog_12411264/" >CTFHub web技能树 RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href= "/2020/03/02/cnblog_12397873/" >快捷指令写爬虫程序</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href= "/2020/03/02/cnblog_12395416/" >ios快捷指令编程尝试</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href= "/2020/03/01/cnblog_12389284/" >n赛 内存取证题解（已更新）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/10</span><a class="archive-post-title" href= "/2020/02/10/cnblog_12290724/" >awd平台搭建</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/11</span><a class="archive-post-title" href= "/2019/06/11/cnblog_11001628/" >文件检测</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/16</span><a class="archive-post-title" href= "/2019/05/16/cnblog_10875920/" >bugku ctf 逆向题</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="WP"><span class="iconfont-archer">&#xe606;</span>WP</span>
    
        <span class="sidebar-tag-name" data-tags="MISC"><span class="iconfont-archer">&#xe606;</span>MISC</span>
    
        <span class="sidebar-tag-name" data-tags="forensic"><span class="iconfont-archer">&#xe606;</span>forensic</span>
    
        <span class="sidebar-tag-name" data-tags="博客园"><span class="iconfont-archer">&#xe606;</span>博客园</span>
    
        <span class="sidebar-tag-name" data-tags="搬家"><span class="iconfont-archer">&#xe606;</span>搬家</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="WP"><span class="iconfont-archer">&#xe60a;</span>WP</span>
    
        <span class="sidebar-category-name" data-categories="MISC"><span class="iconfont-archer">&#xe60a;</span>MISC</span>
    
        <span class="sidebar-category-name" data-categories="笔记"><span class="iconfont-archer">&#xe60a;</span>笔记</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "sharun"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


